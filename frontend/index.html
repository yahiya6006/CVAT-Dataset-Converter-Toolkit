<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CVAT Dataset Converter Utility</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="./css/styles.css" />
</head>
<body>
  <div class="app-root">
    <header class="app-header">
      <h1>CVAT Dataset Converter Utility</h1>
      <p class="subtitle">
        Upload CVAT datasets and prepare them for YOLO / Pascal VOC / TAO
      </p>
    </header>

    <main class="app-main">
      <section class="card">
        <!-- Step 1: Upload zip -->
        <section class="step">
          <h2 class="step-title">Step 1 — Upload dataset ZIP</h2>
          <p class="step-description">
            Expected structure: <code>annotations.xml</code> + <code>images/frame_XXXXX.png</code>.
          </p>

          <label class="field">
            <span class="field-label">Dataset ZIP file</span>
            <input
              type="file"
              id="zipFileInput"
              accept=".zip"
            />
          </label>

          <p id="fileInfo" class="muted">No file selected yet.</p>
        </section>

        <!-- Step 2: Input format -->
        <section class="step">
          <h2 class="step-title">Step 2 — Input format</h2>
          <label class="field">
            <span class="field-label">Select input annotation format</span>
            <select id="inputFormatSelect">
              <option value="">-- Select input format --</option>
              <option value="cvat_images_1_1">CVAT for images 1.1</option>
              <!-- Future formats can be added here -->
            </select>
          </label>
        </section>

        <!-- Step 3: Feature selection -->
        <section class="step">
          <h2 class="step-title">Step 3 — What do you want to do?</h2>

          <fieldset class="field">
            <legend class="field-label">Feature type</legend>

            <label class="radio-option">
              <input
                type="radio"
                name="featureType"
                value="convert_only"
              />
              <span>
                Convert labels only
                <span class="muted">— keep original images, only convert annotation format.</span>
              </span>
            </label>

            <label class="radio-option">
              <input
                type="radio"
                name="featureType"
                value="resize_and_convert"
              />
              <span>
                Resize images + convert labels
                <span class="muted">— resize all images and adjust labels accordingly.</span>
              </span>
            </label>

            <label class="radio-option">
              <input
                type="radio"
                name="featureType"
                value="crop_objects"
              />
              <span>
                Crop labelled objects
                <span class="muted">— ignore conversions, export crops per bounding box.</span>
              </span>
            </label>
          </fieldset>

          <!-- Feature-specific options -->
          <div id="featureOptions">
            <!-- Resize options -->
            <div id="resizeOptions" class="feature-options hidden">
              <h3 class="feature-title">Resize options</h3>

              <div class="two-column">
                <label class="field">
                  <span class="field-label">Target width (px)</span>
                  <input
                    type="number"
                    id="resizeWidthInput"
                    min="1"
                    placeholder="e.g. 640"
                  />
                </label>
                <label class="field">
                  <span class="field-label">Target height (px)</span>
                  <input
                    type="number"
                    id="resizeHeightInput"
                    min="1"
                    placeholder="e.g. 640"
                  />
                </label>
              </div>

              <label class="field checkbox-field">
                <input
                  type="checkbox"
                  id="preserveAspectCheckbox"
                  checked
                />
                <span>Preserve aspect ratio (may pad with borders).</span>
              </label>
            </div>

            <!-- Crop options -->
            <div id="cropOptions" class="feature-options hidden">
              <h3 class="feature-title">Cropping options</h3>

              <div class="two-column">
                <label class="field">
                  <span class="field-label">Padding around object (px)</span>
                  <input
                    type="number"
                    id="cropPaddingInput"
                    min="0"
                    value="10"
                  />
                </label>
              </div>

              <label class="field checkbox-field">
                <input
                  type="checkbox"
                  id="cropPerClassCheckbox"
                  checked
                />
                <span>Organise crops in per-class folders.</span>
              </label>
            </div>
          </div>
        </section>

        <!-- Step 4: Target format (YOLO only) -->
        <section class="step" id="targetFormatSection">
          <h2 class="step-title">Step 4 — Target format</h2>
          <label class="field">
            <span class="field-label">Convert annotations to</span>
            <select id="targetFormatSelect">
              <option value="">-- Select target format --</option>
              <option value="yolo">YOLO (v8-style labels)</option>
            </select>
          </label>
          <p class="muted">
            Note: When you select YOLO, this tool uses YOLOv8-style label files (class x_center y_center width height, all normalised).  
            This format is compatible with YOLOv5, YOLOv7, YOLOv8, YOLOv9 and YOLOv10.
          </p>
        </section>

        <!-- Action + status -->
        <section class="step step-footer">
          <button
            id="nextButton"
            type="button"
            disabled
          >
            Next
          </button>

          <div
            id="statusArea"
            class="status"
            role="status"
            aria-live="polite"
          ></div>
        </section>
      </section>
    </main>

    <footer class="app-footer">
      <span class="muted">© 2025 • CVAT Dataset Converter Utility • Developed by Yahiya Mulla</span>
    </footer>
  </div>

  <script type="module" src="./js/app.js"></script>
</body>
</html>
